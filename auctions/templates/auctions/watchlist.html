{% extends "auctions/layout.html" %} 
{% block title %} {{ current_user.username }}'s Watchlist {% endblock %} 
{% block navbar %}
<li class="nav-item">
  <a class="nav-link" href="{% url 'index' %}">Active Listings</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="{% url 'listings' %}">All Listings</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="{% url 'create' %}">Create Listing</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="{% url 'categories' %}">All Categories</a>
</li>
<li class="nav-item">
    <a class="nav-link" href="{% url 'messages' current_user.id %}">Messages</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="{% url 'profile' current_user.id %}">My Yard</a>
</li>
{% endblock %} 
{% block body %}
<div class="watchlist-content">
  <h1>{{ current_user.username }}'s Watchlist</h1>
  {% if listings %}
  <ul>
    {% for listing in listings %}
    <li class="watchlist-listing">
      <a href="{% url 'listing' listing.id %}">{{ listing.title }}</a>
      <p class="winner-para" style="display: inline">
        {% if listing.active == False %} 
          -- BIDDING CLOSED -- <br/>
          {% for winner in winners %} 
            {% if winner.listing == listing and winner.user == user %} 
              You Won! (See email for details on how to proceed.) 
            {% else %} 
              Winner: {{ winner.user.username}}
            {% endif %} 
          {% endfor %} 
        {% else %} 
          Current Bid: {{ listing.price }} 
        {% endif %}
      </p>
      <form action="/remove_from_watchlist/{{ listing.id }}" method="post">
        {% csrf_token %}
        <button class="btn btn-primary cancel-btn" id="remove-from-watchlist-btn" type="submit">Remove from Watchlist</button>
      </form>
    </li>
    {% endfor %}
  </ul>
  {% else %}
  <p>Your watchlist is empty.</p>
  {% endif %}
</div>
{% endblock %}
