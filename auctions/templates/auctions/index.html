{% extends "auctions/layout.html" %}

{% load static %}

{% block title %}
    Active Listings
{% endblock %}

{% block script %}
    <script src="{% static 'auctions/sort.js' %}" defer></script>
{% endblock %}

{% block navbar %}
    <li class="nav-item">
        <a class="nav-link" href="{% url 'listings' %}">All Listings</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="{% url 'create' %}">Create Listing</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="{% url 'watchlist' %}">Watchlist</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="{% url 'categories' %}">All Categories</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="{% url 'profile' user.id %}">My Yard</a>
    </li>
{% endblock %}

{% block body %}
    <div class="page-content">
        <h2 id="active-listings" class="page-heading-h2">Active Listings</h2>

        <form
            class="sort-by-form"
            action="{% url 'sort' %}"
            method="post"
        >
            {% csrf_token %}
            <input type="hidden" name="sort-by" id="sort-by" value="" />
            <input
            type="hidden"
            name="sort-by-direction"
            id="sort-by-direction"
            value=""
            />
            <input type="hidden" name="page" id="page" value="index"/>
        </form>


        <div class="sort-by-container">
            <p class="sort-by-option" data-sort-by="title">Title</p>
            <p class="sort-by-option" data-sort-by="seller">Seller</p>
            <p class="sort-by-option" data-sort-by="date">Listing Date</p>
            <p class="sort-by-option" data-sort-by="price">Price</p>
        </div>
        <ul>
            {% for listing in listings %}
                {% if listing.active == True %}
                    <li class="li-listing">
                        <div class="thumb-title-div">
                            {% if listing.image != "" %}
                            <div class="thumb-div">
                                <img src="{{ listing.image }}" height="120" width="120">
                            </div>
                            {% else %}
                            <div class="thumb-div">
                                <img src="{% static 'images/No_Image_Available.jpg' %}" height="120" width="120">
                            </div>
                            {% endif %}
                            <div class="list-desc-div">
                                <a class="big-a bold" href="{% url 'listing' listing.id %}">{{ listing.title }}</a>
                                <p>
                                    <span class="bold">Current Bid:&nbsp; </span> ${{ listing.price }}</br>
                                    <span class="bold">Description:&nbsp; </span> {{ listing.description }}</br>
                                    <span class="bold">Seller:&nbsp; </span> <a class="small-a" href="{% url 'profile' listing.user.id %}">{{ listing.user.username }}</a></br>
                                </p>    
                        </div>
                    </li>
                    <hr>
                    </br>
                {% endif %}
            {% endfor %}
        </ul>
        <p><span id="back-to-top">Back to top</span></p>
    </div>
    
{% endblock %}